# myfont.py - Enthält beide Font-Groessen im MONO_VLSB Format

import framebuf

# --- FONT 1: 12x16 (24 Bytes/Zeichen) ---

font_12x16_packed = {
    'A': b'\x00\xf8\xfc\x86\x82\x81\x81\x82\x86\xfc\xf8\x00\x00\xff\xff\x01\x01\x01\x01\x01\x01\xff\xff\x00',
    'B': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\xfe|\x00\x00\xff\xff\xc1\xc1\xc1\xc1\xc1\xc1\xff>\x00',
    'C': b'\x00\xf8\xfc\x06\x03\x03\x03\x03\x06\x0c\x08\x00\x00\x1f?`\xc0\xc0\xc0\xc0`0\x10\x00',
    'D': b'\x00\xff\xff\x03\x03\x03\x03\x03\x03\xfc\xfc\x00\x00\xff\xff\xc0\xc0\xc0\xc0\xc0\xc0??\x00',
    'E': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\x83\x03\x00\x00\xff\xff\xc1\xc1\xc1\xc1\xc1\xc1\xc1\xc0\x00',
    'I': b'\x00\x03\x03\x03\x03\xff\xff\x03\x03\x03\x03\x00\x00\xc0\xc0\xc0\xc0\xff\xff\xc0\xc0\xc0\xc0\x00',
    'K': b'\x00\xff\xff\x80\xc0`0\x18\x0c\x07\x03\x00\x00\xff\xff\x03\x06\x0c\x180`\xc0\x80\x00',
    'L': b'\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xc0\xc0\xc0\xc0\xc0\xc0\xc0\xc0\x00',
    'M': b'\x00\xff\xfe\x1c8``8\x1c\xfe\xff\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\x00',
    'N': b'\x00\xff\xff\x180`\xc0\x80\x00\xff\xff\x00\x00\xff\xff\x00\x00\x00\x00\x01\x03\xff\xff\x00',
    'O': b'\x00\xf8\xfc\x06\x03\x03\x03\x03\x06\xfc\xf8\x00\x00??@\xc0\xc0\xc0\xe0`??\x00',
    'P': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\xfe|\x00\x00\xff\xff\x01\x01\x01\x01\x01\x01\x01\x00\x00',
    'R': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\xfe|\x00\x00\xff\xff\x03\x06\x0c\x180`\xc0\x80\x00',
    'S': b'\x008|F\x83\x83\x03\x03\x06\x0c\x08\x00\x00\x100`\xc0\xc0\xc1\xc1b>\x1c\x00',
    'T': b'\x00\x03\x03\x03\x03\xff\xff\x03\x03\x03\x03\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00',
    'U': b'\x00\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x1f?`\xc0\xc0\xc0\xc0`?\x1f\x00',
    'W': b'\x00\xff\xff\x00\x00\x80\x80\x00\x00\xff\xff\x00\x00\xff\x7f\x0e\x07\x01\x01\x07\x0e\x7f\xff\x00',
    '0': b'\x00\xf8\xfc\x06\x03\x03\x03\x03\x06\xfc\xf8\x00\x00\x1f?`\xc0\xc0\xc0\xc0`?\x1f\x00',
    '1': b'\x00\x00\x08\x0c\x06\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00',
    '2': b'\x00\x08\x0c\x06\x03\x03\x03\x03\x86\xfcx\x00\x00\xe0\xf0\xd0\xc8\xcc\xc6\xc3\xc1\xc0\x00\x00',
    '3': b'\x00\x08\x0c\x06\x03\x83\x83\x83\x86\xfcx\x00\x00\x100`\xc0\xc1\xc1\xc1a?\x1e\x00',
    '4': b'\x00\x80\xc0\xe0\xb0\x98\x8c\x86\x82\xff\xff\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\xff\xff\x00',
    '5': b'\x00\xff\xff\xc3\xc3\xc3\xc3\xc3\xc3\xc3\x00\x00\x00\x100`\xc0\xc0\xc0\xc0`?\x1f\x00',
    '6': b'\x00\xf8\xfc\xc6\xc3\xc3\xc3\xc3\xc6\xcc\x08\x00\x00\x1e?a\xc1\xc0\xc0\xc1a?\x1e\x00',
    '7': b'\x00\x03\x03\x03\x03\x03\x83\xe3{\x1f\x07\x00\x00\x00\x80\xe0x\x1e\x07\x01\x00\x00\x00\x00',
    '8': b'\x008\xfc\xc6\xc3\x83\x83\xc3\xc6\xfc8\x00\x00\x1e?a\xc1\xc0\xc0\xc1a?\x1e\x00',
    '9': b'\x008\xfc\xc6\xc3\x83\x83\xc3\xc6\xfc8\x00\x00\x100a\xc1\xc0\xc0\xc1a?\x1e\x00',
    '.': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf0\xf0\x00\x00\x00\x00\x00\x00\x00',
    '-': b'\x00\x80\x80\x80\x80\x80\x80\x80\x80\x80\x80\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00',
    ' ': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',
}

# --- FONT 2: 16x21 (48 Bytes/Zeichen) ---

font_16x21_packed = {
    '0': b'\x00\x00\x00\x1e\x00\x00?\x00\x00s\xc0\x01q\xe0\x03p\xf0\x03p\xf8\x03p\xfc\x03p\xfe\x03p\xff\x03p\xff\x03p\xff\x03p\xff\x03p\xff\x03p\xff\x03p\xff\x03p\xff\x03?\x00\x00\x1e\x00\x00\x00\x00\x00',
    '1': b'\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x1f\x00\x00?\xc0\x01\xef\xe0\x01\xef\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x0f\xf0\x03\x00\x00\x00\x00\x00\x00',
    '2': b'\x00\x00\x00\x1e\x00\x00?\x00\x00s\xc0\x01q\xe0\x03p\xf0\x03`\x18\x03\x00\x1c\x03\x00\x0e\x03\x00\x07\x03\x80\x03\x03\xc0\x01\x03\xe0\x00\x03p\x00\x03x\x00\x03|\x00\x03?\xff\x3f?\xff\x3f?\xff\x3f',
    '3': b'\x00\x00\x00\x1e\x00\x00?\x00\x00s\xc0\x01q\xe0\x03p\xf0\x03`\x18\x03\x00\x0c\x03\x00\x1c\x03\x00\xf8\x03\x00\xf0\x01\x00\xe0\x01\x00\xc0\x03q\xe0\x07s\xc0\x0fq\xe0\x1ep\xc0\xfc\x00\x00x\x00\x00',
    '4': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x07\x00\xc0\x0f\x00\xe0\x1f\x00\xe0\x1b\x00\xe0\x1b\x00\xe0\x03\x00\xe0\x03\x00\xe0\x01\x00\xe0\x01\x00\xe0\x00\x00\xe0\x00\x00\xff\xff\xff\xff\xff\xff\x07\x00\x00\x07\x00\x00',
    '5': b'\x00\xff\xff\x3f\x80\xff\xff\x3f\xc0\xff\xff\x3f\xe0\x00\x00\x00\xf0\x00\x00\x00\xf8\x00\x00\x00\xfc\x00\x00\x00\xfe\x00\x00\x00\xff\x00\x00\x00\xff\x80\x00\x00\xff\xc0\x01\x00\xfe\xe0\x03\x00\xf7\xf0\x07\x00\xe7\xf8\x0f\x00\xc6',
    '6': b'\x00\x00\x00\x1e\x00\x00?\x00\x00s\xc0\x01q\xe0\x03p\xf0\x03`\x00\x03\x00\x00\x03\x00\x00\x03\x00\x00\x03\xf0\x07\x03\xf8\x0f\x03\xfc\x1f\x03\xfe?\x03\xff\x7f\x03\xef\xef\x03\xc7\xc7\x03\xc3\x83\x03\x80\x00\x00',
    '7': b'\x00\xff\xff\x3f\x80\xff\xff\x3f\xc0\xff\xff\x3f\xe0\x00\x00\x00\xf0\x00\x00\x00\xf8\x00\x00\x00\xfc\x00\x00\x00\xfe\x00\x00\x00\x7f\x00\x00\x00?\x80\x00\x00\x1f\xc0\x00\x00\x0f\xe0\x00\x00\x07\xf0\x00\x00\x03\xf8\x00\x00\x01',
    '8': b'\x00\x00\x00\x1e\x00\x00?\x00\x00s\xc0\x01q\xe0\x03p\xf0\x03`\xf8\x03\x00\xfc\x03\x00\x9e\x03\x00\x0f\x03\xf0\x07\x03\xf8\x0f\x03\xfc\x1f\x03\xfe?\x03\xef\xef\x03\xc7\xc7\x03\xc3\x83\x03\xc3\x83\x03\x80\x00\x00',
    '9': b'\x00\x00\x00\x1e\x00\x00?\x00\x00s\xc0\x01q\xe0\x03p\xf0\x03`\xf8\x03\x00\xfc\x03\x00\xfe\x03\x00\xff\x03\xf0\xff\x03\xf8\xff\x03\xfc\x7f\x03\xfe?\x03\xef\xef\x03\xc7\xc7\x03\xc3\x83\x03\xc0\x01\x00',
    '.': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf0\x01\x00\xf0\x01\x00\xf0\x01\x00\xf0\x01\x00',
    ' ': b'\x00\x00\x00' * 16,  # 48 Nullen
}

# --- FONT KLASSE ZUR VERWENDUNG MIT FRAMEBUF ---

class MyFont:
    """
    Kombinierter Font für MicroPython framebuf.
    Initialisierung mit der gewünschten Größe ('small' oder 'large').
    """

    def __init__(self, size='small'):
        self.size = size.lower()
        if self.size == 'small':
            self.font_data = font_12x16_packed
            self.width = 12
            self.height = 16
            # Korrektur: 16 Zeilen * 2 Bytes/Zeile = 32 Bytes für MONO_VLSB (12 Spalten * 2 Bytes/Spalte)
            self.byte_count = 24 
            # HINWEIS: Hier ist der Byte-Count 24, was 12x16 * MONO_HLSB oder 12x12 * MONO_VLSB entspricht.
            # Da Sie MONO_VLSB verwenden, sollten Sie diesen Wert überprüfen.
            # Wenn 12x16 VLSB: 12 Spalten * ceil(16/8) = 12 * 2 = 24 Bytes. DIES IST KORREKT.
            
        elif self.size == 'large':
            self.font_data = font_16x21_packed
            self.width = 16
            self.height = 21
            # Korrektur: 16 Spalten * ceil(21/8) = 16 * 3 = 48 Bytes
            self.byte_count = 48 
        else:
            raise ValueError("Ungültige Font-Größe. Wähle 'small' (12x16) oder 'large' (16x21).")

        # Prüfe, ob alle Daten in der richtigen Größe vorliegen
        for char, data in self.font_data.items():
            if len(data) != self.byte_count:
                raise ValueError(f"Datenfehler für '{char}': Erwartet {self.byte_count} Bytes, fand {len(data)}.")

    # framebuf-kompatible Methoden
    
    def get_ch(self, char_code):
        """
        Gibt die Rohdaten, Breite, Höhe und Format für framebuf zurück.
        char_code ist der Integer-ASCII-Code.
        """
        try:
            char = chr(char_code)
            # Fallback auf Leerzeichen, wenn das Zeichen nicht definiert ist
            data = self.font_data.get(char, self.font_data[' ']) 
            
            return data, self.width, self.height, framebuf.MONO_VLSB
            
        except KeyError:
            return self.font_data[' '], self.width, self.height, framebuf.MONO_VLSB

    # Optional: Eine Methode zur Berechnung der Textbreite
    def get_text_width(self, text):
        return len(text) * self.width    'R': b'\xFF\xFF\x0F\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x18\x01\x00\x10\xFF\xFF\x10\xFF\xFF\x10\xFF\xFF\x10\x01\xE0\x10\x01\x80\x10\x01\x80\x1C\x01\x00\x16\x01\x00\x13\x01\x00\x11\x01\x00\x10\x01\x00\x10',
    'N': b'\xFE\xFF\x07\x02\x00\x04\x02\x00\x04\x06\x00\x04\x0E\x00\x04\x1E\x00\x04\x3E\x00\x04\x7E\x00\x04\xE6\x00\x04\xC6\x00\x04\x86\x00\x04\x06\x00\x04\x06\x00\x04\x06\x00\x06\x06\x00\x07\x06\x00\x03\x06\x00\x03\x06\x00\x01\x06\x00\x01',
    'D': b'\xFF\xFF\x0F\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x08\x01\x00\x18\x01\x00\x18\xFF\xFF\x1F\xFF\xFF\x0F\xFF\xFF\x07',
